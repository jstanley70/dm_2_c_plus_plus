//Macintosh HD:CodeWarriorª DR/3 Gold Ä:Metrowerks  C/C++ Ä:Projects:D.M. v2.0:Sources.Jim:Desktop.2.0:Defects 2:DE2_DislocImageCond.c#include	"Diffract_INCs.h"#include 	"DislocImageCond.h"void		DislocImageCond::DoInit			(PictObj *thePict){		next = 0L;	defectSetting 	= 	0;	beamSetting		=	0;	thicknessSetting =  0;	thePicture		=	thePict;}void	 		DislocImageCond::Add			(short defect,short beam){	if((long)next != 0L){	 	next->Add(defect,beam);		return;	}	next			=	(DislocImageCond*)D_new(DislocImageCond);	next->DoInit((PictObj*)0L);	next->defectSetting 	= 	defect;	next->beamSetting		=	beam;	}PictObj*			DislocImageCond::CleanImages(PictObj *picObjList){	if(picObjList == 0L)return picObjList;	picObjList->ClearSelects();	if(picObjList->SelectPictObj(thePicture)){		thePicture = 0L;		picObjList = picObjList->KillSelected();	}	if((long)next != 0L){	 	return next->CleanImages(picObjList);	}		return picObjList;	}void			DislocImageCond::SetPict		(PictObj *thePict){	if((long)next != 0L){	 	next->SetPict(thePict);		return;	}	thePicture		=	thePict;}void			DislocImageCond::Kill			(void){//	if(thePicture)thePicture->DoClose();	D_delete(this);}void			DislocImageCond::KillAll		(void){	if((long)next != 0L){	 	next->KillAll();	}	Kill();	return;}Boolean			DislocImageCond::GetSettings	(short *defect,short *beam,short *slice,PictObj *thePict){	if(thePict == thePicture){		*defect = 	defectSetting;		*beam	=	beamSetting;		*slice	=	thicknessSetting;		return true;	}	if(next != 0L){	 			return next->GetSettings(defect,beam,slice,thePict);	}	return false;}void			DislocImageCond::AddThickness	(short sliceNo){	if((long)next != 0L){	 	next->AddThickness(sliceNo);	 	return;	}	Add(defectSetting,beamSetting);	next->thicknessSetting = sliceNo;	return;}Boolean 			DislocImageCond::ReadImage			(PictObj *aPict){	if(gTheFile->ReadBoolean()){		beamSetting		=	gTheFile -> ReadShort();		defectSetting	=	gTheFile -> ReadShort();		thicknessSetting	=	gTheFile -> ReadShort();		thePicture			=	aPict;		if(thePicture != 0L) aPict				=	aPict->nextObj;					next = (DislocImageCond*)D_new(DislocImageCond);		next	->beamSetting		= 	-1;		next	-> defectSetting	=	-1;		next	-> thePicture		=	0L;		if(next	-> ReadImage(aPict)){			next -> Kill();			next = 0L;		}		return false;	}else{		return true;	}	}void 			DislocImageCond::WriteImage			(void){	gTheFile	->	WriteBoolean(true);	gTheFile 	-> 	WriteShort(beamSetting);	gTheFile 	-> 	WriteShort(defectSetting);	gTheFile 	-> 	WriteShort(thicknessSetting);	if(next == 0L){		gTheFile->WriteBoolean(false);		return;	}	next->WriteImage();	return;}void DislocImageCond::DrawDisPicture(void){	if(next != 0L)next->DrawDisPicture();	thePicture->DrawThePicts();}