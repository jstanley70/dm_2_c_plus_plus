/* corth.f -- translated by f2c (version 19941113).   You must link the resulting object file with the libraries:	-lf2c -lm   (in that order)*/#define IM_1  	m - 1][i#define IJ		j][i#define	MM_1	m - 1][m/*#define IM_1  	i][m - 1#define IJ		i][j#define	MM_1	m][m - 1*///rows and columns switched#include "f2c.h"/* Subroutine */ int corth_(integer *nm, integer *n, integer *low, integer *	igh, rreal **ar, rreal **ai, rreal *ortr, rreal *orti){    /* System generated locals */    integer  i__1, i__2, i__3;    rreal r__1, r__2;    /* Builtin functions */   // double sqrt(doublerreal);    /* Local variables */    rreal f, g, h;    integer i, j, m;    rreal scale;    integer la;    rreal fi;    integer ii, jj;    rreal fr;    integer mp;    extern rreal pythag_(rreal *, rreal *);    integer kp1;	*nm = *nm;/* ***FIRST EXECUTABLE STATEMENT  CORTH */    /* Parameter adjustments *///    ai_dim1 = *nm;//    ai_offset = ai_dim1 + 1;//    ai -= ai_offset;//    ar_dim1 = *nm;//    ar_offset = ar_dim1 + 1;//    ar -= ar_offset;//    --ortr;//    --orti;    /* Function Body */    la = *igh - 1;    kp1 = *low + 1;    if (la < kp1) {	goto L200;    }    i__1 = la;    for (m = kp1; m <= i__1; ++m) {	h = 0.f;	ortr[m] = 0.f;	orti[m] = 0.f;	scale = 0.f;/*     .......... SCALE COLUMN (ALGOL TOL THEN NOT NEEDED) .......... */	i__2 = *igh;	for (i = m; i <= i__2; ++i) {/* L90: */	    scale = scale + (r__1 = ar[IM_1], abs(r__1)) + (		    r__2 = ai[IM_1], abs(r__2));	}	if (scale == 0.f) {	    goto L180;	}	mp = m + *igh;/*     .......... FOR I=IGH STEP -1 UNTIL M DO -- .......... */	i__2 = *igh;	for (ii = m; ii <= i__2; ++ii) {	    i = mp - ii;	    ortr[i] = ar[IM_1] / scale;	    orti[i] = ai[IM_1] / scale;	    h = h + ortr[i] * ortr[i] + orti[i] * orti[i];/* L100: */	}	g = sqrt(h);	f = pythag_(&ortr[m], &orti[m]);	if (f == 0.f) {	    goto L103;	}	h += f * g;	g /= f;	ortr[m] = (g + 1.f) * ortr[m];	orti[m] = (g + 1.f) * orti[m];	goto L105;L103:	ortr[m] = g;	ar[MM_1] = scale;/*     .......... FORM (I-(U*UT)/H) * A .......... */L105:	i__2 = *n;	for (j = m; j <= i__2; ++j) {	    fr = 0.f;	    fi = 0.f;/*     .......... FOR I=IGH STEP -1 UNTIL M DO -- .......... */	    i__3 = *igh;	    for (ii = m; ii <= i__3; ++ii) {		i = mp - ii;		fr = fr + ortr[i] * ar[IJ] + orti[i] * ai[IJ];		fi = fi + ortr[i] * ai[IJ] - orti[i] * ar[IJ];/* L110: */	    }	    fr /= h;	    fi /= h;	    i__3 = *igh;	    for (i = m; i <= i__3; ++i) {		ar[IJ] = ar[IJ] - fr * ortr[i] + fi * orti[i];		ai[IJ] = ai[IJ] - fr * orti[i] - fi * ortr[i];/* L120: */	    }/* L130: */	}/*     .......... FORM (I-(U*UT)/H)*A*(I-(U*UT)/H) .......... */	i__2 = *igh;	for (i = 1; i <= i__2; ++i) {	    fr = 0.f;	    fi = 0.f;/*     .......... FOR J=IGH STEP -1 UNTIL M DO -- .......... */	    i__3 = *igh;	    for (jj = m; jj <= i__3; ++jj) {		j = mp - jj;		fr = fr + ortr[j] * ar[IJ] - orti[j] * ai[IJ];		fi = fi + ortr[j] * ai[IJ] + orti[j] * ar[IJ];/* L140: */	    }	    fr /= h;	    fi /= h;	    i__3 = *igh;	    for (j = m; j <= i__3; ++j) {		ar[IJ] = ar[IJ] - fr * ortr[j] - fi * orti[j];		ai[IJ] = ai[IJ] + fr * orti[j] - fi * ortr[j];/* L150: */	    }/* L160: */	}	ortr[m] = scale * ortr[m];	orti[m] = scale * orti[m];	ar[MM_1] = -g * ar[MM_1];	ai[MM_1] = -g * ai[MM_1];L180:	;    }L200:    return 0;} /* corth_ */