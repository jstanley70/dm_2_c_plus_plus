/* Inverse.f -- translated by f2c (version 19941113).   You must link the resulting object file with the libraries:	-lf2c -lm   (in that order)*/#include "f2c.h"#include "FortranProtos.h"/* Table of constant values */static ccomplex c_b11 = {1.f,0.f};/*double c_abs(ccomplex *z);ccomplex c_div(ccomplex *a, ccomplex *b);ccomplex c_div(ccomplex a, ccomplex b){	ccomplex c;	double r,den;	if (fabs(b.r) >= fabs(b.i)) {		r=b.i/b.r;		den=b.r+r*b.i;		c.r=(a.r+r*a.i)/den;		c.i=(a.i-r*a.r)/den;	} else {		r=b.r/b.i;		den=b.i+r*b.r;		c.r=(a.r*r+a.i)/den;		c.i=(a.i*r-a.r)/den;	}	return c;}double c_abs(ccomplex *z){	double x,y,ans,temp;	x=fabs(*z.r);	y=fabs(*z.i);	if (x == 0.0)		ans=y;	else if (y == 0.0)		ans=x;	else if (x > y) {		temp=y/x;		ans=x*sqrt(1.0+temp*temp);	} else {		temp=x/y;		ans=y*sqrt(1.0+temp*temp);	}	return ans;}*//* Subroutine */ int inverse_(integer *nm, integer *n, ccomplex *a, ccomplex *b,	 integer *ierr){    /* System generated locals */    integer a_dim1, a_offset, i__1, i__2, i__3, i__4, i__5, i__6;    ccomplex q__1, q__2;    /* Builtin functions */   // double c_abs(ccomplex *);   // void c_div(ccomplex *, ccomplex *, ccomplex *);    /* Local variables */    ccomplex zero;    integer ipvt[100], jpvt, i, j, k, m;    ccomplex t;    integer kb, kp1, nm1;    rreal amx;/*   to calculate the first row of c-inverse by Gaussian elimination *//*   and back substitution *//*     by j.m. zuo oct. 1987 */    /* Parameter adjustments */    --b;    a_dim1 = *nm;    a_offset = a_dim1 + 1;    a -= a_offset;    /* Function Body */    *ierr = 100;    zero.r = 0.f, zero.i = 0.f;    if (*n == 1) {	goto L35;    }    amx = 0.f;/*   pivoting for the first row */    i__1 = *n;    for (j = 1; j <= i__1; ++j) {	if (c_abs(&a[j * a_dim1 + 1]) > amx) {	    amx = c_abs(&a[j * a_dim1 + 1]);	    jpvt = j;	} else {	}/* L5: */    }    i__1 = *n;    for (i = 1; i <= i__1; ++i) {	i__2 = i + jpvt * a_dim1;	t.r = a[i__2].r, t.i = a[i__2].i;	i__2 = i + jpvt * a_dim1;	i__3 = i + *n * a_dim1;	a[i__2].r = a[i__3].r, a[i__2].i = a[i__3].i;	i__2 = i + *n * a_dim1;	a[i__2].r = t.r, a[i__2].i = t.i;/* L10: */    }/*   interchange firt row and last row */    i__1 = *n;    for (i = 1; i <= i__1; ++i) {	i__2 = i * a_dim1 + 1;	t.r = a[i__2].r, t.i = a[i__2].i;	i__2 = i * a_dim1 + 1;	i__3 = *n + i * a_dim1;	a[i__2].r = a[i__3].r, a[i__2].i = a[i__3].i;	i__2 = *n + i * a_dim1;	a[i__2].r = t.r, a[i__2].i = t.i;/* L12: */    }/*   Gaussian elimination with partial pivoting */    nm1 = *n - 1;    i__1 = nm1;    for (k = 1; k <= i__1; ++k) {	kp1 = k + 1;	m = k;	if (kp1 == nm1 || k == nm1) {	    goto L15;	}	i__2 = nm1;	for (i = kp1; i <= i__2; ++i) {	    if (c_abs(&a[i + k * a_dim1]) > c_abs(&a[m + k * a_dim1])) {		m = i;	    }L15:	    ;	}	ipvt[k - 1] = m;	i__2 = m + k * a_dim1;	t.r = a[i__2].r, t.i = a[i__2].i;	i__2 = m + k * a_dim1;	i__3 = k + k * a_dim1;	a[i__2].r = a[i__3].r, a[i__2].i = a[i__3].i;	i__2 = k + k * a_dim1;	a[i__2].r = t.r, a[i__2].i = t.i;	if (c_abs(&t) <= 1e-7f) {	    goto L35;	}	i__2 = *n;	for (i = kp1; i <= i__2; ++i) {	    i__3 = i + k * a_dim1;	    i__4 = i + k * a_dim1;	    q__2.r = -a[i__4].r, q__2.i = -a[i__4].i;	    c_div(&q__1, &q__2, &t);	    a[i__3].r = q__1.r, a[i__3].i = q__1.i;/* L20: */	}	i__2 = *n;	for (j = kp1; j <= i__2; ++j) {	    i__3 = m + j * a_dim1;	    t.r = a[i__3].r, t.i = a[i__3].i;	    i__3 = m + j * a_dim1;	    i__4 = k + j * a_dim1;	    a[i__3].r = a[i__4].r, a[i__3].i = a[i__4].i;	    i__3 = k + j * a_dim1;	    a[i__3].r = t.r, a[i__3].i = t.i;	    if (t.r == zero.r && t.i == zero.i) {		goto L30;	    }	    i__3 = *n;	    for (i = kp1; i <= i__3; ++i) {		i__4 = i + j * a_dim1;		i__5 = i + j * a_dim1;		i__6 = i + k * a_dim1;		q__2.r = a[i__6].r * t.r - a[i__6].i * t.i, q__2.i = a[i__6]			.r * t.i + a[i__6].i * t.r;		q__1.r = a[i__5].r + q__2.r, q__1.i = a[i__5].i + q__2.i;		a[i__4].r = q__1.r, a[i__4].i = q__1.i;/* L25: */	    }L30:	    ;	}L35:	;    }    if (c_abs(&a[*n + *n * a_dim1]) <= 1e-7f) {	*ierr = 0;    }/*   back substitution to get x */    i__1 = *n;    c_div(&q__1, &c_b11, &a[*n + *n * a_dim1]);    b[i__1].r = q__1.r, b[i__1].i = q__1.i;    i__1 = *n;    for (kb = 2; kb <= i__1; ++kb) {	k = *n - kb + 1;	kp1 = k + 1;	i__2 = k;	b[i__2].r = zero.r, b[i__2].i = zero.i;	i__2 = *n;	for (j = kp1; j <= i__2; ++j) {/* L40: */	    i__3 = k;	    i__4 = k;	    i__5 = k + j * a_dim1;	    i__6 = j;	    q__2.r = a[i__5].r * b[i__6].r - a[i__5].i * b[i__6].i, q__2.i = 		    a[i__5].r * b[i__6].i + a[i__5].i * b[i__6].r;	    q__1.r = b[i__4].r - q__2.r, q__1.i = b[i__4].i - q__2.i;	    b[i__3].r = q__1.r, b[i__3].i = q__1.i;	}	i__3 = k;	c_div(&q__1, &b[k], &a[k + k * a_dim1]);	b[i__3].r = q__1.r, b[i__3].i = q__1.i;/* L50: */    }    i__1 = jpvt;    t.r = b[i__1].r, t.i = b[i__1].i;    i__1 = jpvt;    i__3 = *n;    b[i__1].r = b[i__3].r, b[i__1].i = b[i__3].i;    i__1 = *n;    b[i__1].r = t.r, b[i__1].i = t.i;    return 0;} /* inverse_ */