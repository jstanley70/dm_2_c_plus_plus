//s.Jim:Event/Memory:EV_MiniSwitchboard.c#include		"Diffract_INCs.h"void		MiniSwitchboard(void);#define		SuspendResumeEvt	0x01	/* Suspend/Resume event code		*/#define		ResumeEvtMask		0x1	/* Supend or Resume selector		*/#define		ConvertScrapMask	0x2	/* Scrap conversion flag			*/#define		THE_EVT_MASK	(keyDownMask + updateMask + activMask + app4Mask)void		MiniSwitchboard(){	char				theKey;	WindowPtr			theWindow;	DiffractObject		*thisObject;	short				size;		if(WaitNextEvent(THE_EVT_MASK,&gTheEvent,gWaitTime, gMouseRgn)){			switch(gTheEvent.what){					case keyDown:				theKey = (char)(gTheEvent.message & charCodeMask);				if(gTheEvent.modifiers & cmdKey){					switch(theKey){						case '.':							gNoBreak = false;							SysBeep(10);							break;						default:							break;					}				}				break;											case updateEvt:				size = (*((*(GetGDevice()))->gdPMap))->pixelSize;				theWindow = (WindowPtr)gTheEvent.message;				if(theWindow != (WindowPtr)NUL){					thisObject = (DiffractObject*)GetWRefCon(theWindow);					if(thisObject != (DiffractObject*)NUL){						if(size != gLastPixelSize){							gLastPixelSize = size;							if(IsValidObj(thisObject))								thisObject->SetObjectDrawTransferMode();							else{								gDefault->SetObjectDrawTransferMode();							}						}												if(IsValidObj(thisObject))							thisObject->DoRefresh();						if(gCurrentObj->theWindow != (WindowPtr)NUL){							SetPort(gCurrentObj->theWindow);						}					}				}				break;							case activateEvt:					SetPort(qd.thePort);				if (gTheEvent.modifiers & activeFlag){					DoActivate();				}else{					DoDeactivate();				}				break;												/** MULTIFINDER EVENTS **/			case app4Evt:													/* Event type is stored in the		*/										/*   high byte of the event message	*/										/*   Typecast to unsigned long so	*/										/*   we won't get sign extension	*/										/*   when the bits are shifted		*/				switch ((unsigned long)gTheEvent.message >> 24) {											case SuspendResumeEvt:						if(gTheEvent.message & ResumeEvtMask)							DoResume();						else							DoSuspend();						break;				}				break;							default:					/* Some other event					*/				break;		}	}}