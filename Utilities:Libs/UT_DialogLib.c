//ects:D.M. v2.0:Sources.Jim:Utilities/Libs:UT_DialogLib.c#include	"Diffract_INCs.h"GrafPtr 	theOldPort[10];RgnHandle oldClipR[10];Handle		dialogMBar[10];short			numDialogs;Boolean  SwitchBoolean(DialogPtr theDialog,short theSelect,Boolean theFlag){	GetDItem(theDialog,theSelect,&gType,&gTheHandle,&gTheRect);	if(theFlag){	 	SetCtlValue((ControlHandle)gTheHandle,0);		return false;	}else{	  SetCtlValue((ControlHandle)gTheHandle,1);	  return true;	}}Boolean  GetBoolean(DialogPtr theDialog,short theSelect){	GetDItem(theDialog,theSelect,&gType,&gTheHandle,&gTheRect);	if(GetCtlValue((ControlHandle)gTheHandle) == 0){		return  false;	} else {		return true;	}}void	StatTextItem(DialogPtr theDialog,short num,Boolean flag){	GetDItem(theDialog,num,&gType,&gTheHandle,&gTheRect);	if(flag){		SetDItem(theDialog,num,statText,gTheHandle,&gTheRect);	}	else {		SetDItem(theDialog,num,editText,gTheHandle,&gTheRect);	}}float GetItemValue(DialogPtr theDialog,short i){	char theText[255];	GetDItem(theDialog,i,&gType,&gTheHandle,&gTheRect);	GetIText(gTheHandle,(unsigned char*)theText);	return atof(p2cstr((unsigned char*)theText));}DialogPtr  DM_GetNewDialog(short resource,DialogRecord* dilR,WindowPtr position){	DialogPtr theDialog;	PaletteHandle	oldPalette;		GrafPtr oldPort;	GetPort		(&oldPort);	theOldPort[numDialogs] = oldPort;	UseResFile(g_AppResFile);	SetDialogMenuBar();	SetDAFont(1123);	theDialog		= 		GetNewDialog(resource,dilR,position);		if(!theDialog){		Message(NO_DIALOG);		return 0L;	}	SetPort			(theOldPort[numDialogs - 1]);		ShowWindow	(theDialog);	oldClipR[numDialogs - 1] = SetClipToPort((WindowPtr)theDialog,0,0,0,0);				SetPort			(theDialog);	oldPalette = gCurrentObj->thePalette;	gCurrentObj->thePalette 	= GetNewPalette(1000);//whoa nellie 2/99	DetachResource((Handle)gCurrentObj->thePalette);	gCurrentObj->DMForeColor(BLACK);	gCurrentObj->DMBackColor(WHITE);	if(gCurrentObj->thePalette)DisposePalette(gCurrentObj->thePalette);	gCurrentObj->thePalette = oldPalette;	if(numDialogs == 1)HiliteOK		(theDialog);		//	gCurrentObj->DMBackColor		(BACKGROUND_COLOR);	//	gCurrentObj->DMForeColor		(COMPLEMENT_COLOR);						DrawDialog	(theDialog);	//TextFont(1123);		return theDialog;}void DM_DisposDialog		(DialogPtr* theDialog){				KillDialogMenuBar(); 			/*July 1992 */	if(*theDialog)DisposDialog		(*theDialog);	if(theOldPort[numDialogs])SetPort			(theOldPort[numDialogs]);//		*theDialog = 0L;		theOldPort[numDialogs] = 0L;		if(oldClipR[numDialogs]){		D_SetClip			(oldClipR[numDialogs]);		D_DisposeRgn	(&(oldClipR[numDialogs]));		oldClipR[numDialogs] = 0L;	}	TextFont(0);}void SetItemValue(DialogPtr theDialog,short i,double theValue,short precision){		switch(precision){		case 0:			sprintf(gTheText,"%d",(short)theValue);		break;		case 1:			sprintf(gTheText,"%3.1f",theValue);		break;		case 2:			sprintf(gTheText,"%5.2f",theValue);		break;		case 3:			sprintf(gTheText,"%6.3f",theValue);		break;		case 4:			sprintf(gTheText,"%6.4f",theValue);		break;		case 5:		default:			sprintf(gTheText,"%7.5f",theValue);		break;			}	GetDItem(theDialog,i,&gType,&gTheHandle,&gTheRect);	SetIText(gTheHandle,c2pstr(gTheText));	return ;}void InitDialogSetUpParams(void){	short i;	numDialogs = 0;	for(i = 0; i < 9;i++)	{		dialogMBar[i] = 0;		oldClipR[i] = 0;		theOldPort[i]    = 0;	}}void SetItemText(DialogPtr theDialog,short i,unsigned char *theText){	GetDItem(theDialog,i,&gType,&gTheHandle,&gTheRect);	SetIText(gTheHandle,theText);}void	SetDialogMenuBar(void){		if(numDialogs > 0){		numDialogs++;		return;	}	dialogMBar[numDialogs] = GetMenuBar();	numDialogs++;		ClearMenuBar();/* July 1992 */	dialogMBar[numDialogs] = GetNewMBar(DLOG_MBAR);	SetMenuBar	(dialogMBar[numDialogs]);	DisableItem	(GetMHandle(FILE_MENU),D_PRINT);	DrawMenuBar	();}void	KillDialogMenuBar(void){	Handle	theHandle;		if(numDialogs > 1){		numDialogs--;		return;	}	if(numDialogs <= 0)	{		numDialogs = 0;		D_Debug_Message(19);		return;	}	theHandle = dialogMBar[numDialogs];	if(numDialogs)DisposeHandle(theHandle);	dialogMBar[numDialogs] = 0L;	numDialogs--;	ClearMenuBar();/* July 1992 */	if(numDialogs < 0)	{		numDialogs = 0;		D_Debug_Message(19);		return;	}	if(dialogMBar[numDialogs])SetMenuBar(dialogMBar[numDialogs]);	DisposeHandle((Handle)dialogMBar[numDialogs]);	DrawMenuBar();}